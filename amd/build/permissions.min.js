define(["jquery","core/log","core/ajax","core/str"],function(n,e,r,s){"use strict";function i(s){this.rootel=s}return i.prototype.main=function(){var o=this;o.rootel.on("change",'input[name="permission"]',function(s){var i=n(this);o.submitPermission(i)})},i.prototype.submitPermission=function(s){var i=s.val(),o=s.closest(".permission"),s=(o.find(".c-errormsg").html(""),o.data("id"));o.addClass("submitting"),o.attr("data-status","0"),r.call([{methodname:"local_excursions_submit_permission",args:{permissionid:s,response:i},done:function(s){JSON.parse(s);o.removeClass("submitting"),o.attr("data-status",s)},fail:function(s){o.removeClass("submitting"),e.error("local_excursions/permissions: failed to submit permission."),e.debug(s),o.find(".c-errormsg").html(s)}}])},{init:function(){e.debug("local_excursions/permissions: initializing");var s=n("#page-local-excursions-permissions");s.length?new i(s).main():e.error("local_excursions/permissions: #page-local-excursions-permissions not found!")}}});