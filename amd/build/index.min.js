define(["jquery","core/log","core/ajax","core/str"],function(o,a,s,e){"use strict";function i(e){this.rootel=e}return i.prototype.main=function(){var t=this;t.rootel.on("click",".activities-tab",function(e){e.preventDefault();e=o(this).data("ref");t.rootel.find(".activities-tab").removeClass("selected"),t.rootel.find(".list-activities").removeClass("selected"),o(this).addClass("selected"),t.rootel.find(".list-activities."+e).addClass("selected")}),t.rootel.on("change","input.show-past-activities",function(e){o(this).is(":checked")?t.rootel.addClass("show-past-activities"):t.rootel.removeClass("show-past-activities")}),t.rootel.on("change","input.show-inreview-activities",function(e){o(this).is(":checked")?t.rootel.addClass("show-inreview-activities"):t.rootel.removeClass("show-inreview-activities")}),t.rootel.on("click",".delete-activity",function(e){e.preventDefault();var i=o(this).closest("tr.activity").data("id");t.rootel.find('tr.activity[data-id="'+i+'"]').addClass("deleting"),s.call([{methodname:"local_excursions_formcontrol",args:{action:"delete_activity",data:i},done:function(e){t.rootel.find('tr.activity[data-id="'+i+'"]').remove()},fail:function(e){a.error("local_excursions/index: failed to delete activity."),a.debug(e)}}])}),t.rootel.find("input.show-past-activities").change()},{init:function(){a.debug("local_excursions/index: initializing");var e=o("#page-local-excursions-index");e.length?new i(e).main():a.error("local_excursions/index: #page-local-excursions-index not found!")}}});