define(["jquery","core/log","core/ajax","core/str"],function(o,a,s,t){"use strict";function e(t){this.rootel=t}return e.prototype.main=function(){var i=this;i.rootel.on("click",".activities-tab",function(t){t.preventDefault();t=o(this).data("ref");i.rootel.find(".activities-tab").removeClass("selected"),i.rootel.find(".list-activities").removeClass("selected"),o(this).addClass("selected"),i.rootel.find(".list-activities."+t).addClass("selected")}),i.rootel.on("change","input.show-past-activities",function(t){o(this).is(":checked")?i.rootel.addClass("show-past-activities"):i.rootel.removeClass("show-past-activities")}),i.rootel.on("click",".delete-activity",function(t){t.preventDefault();var e=o(this).closest("tr.activity").data("id");i.rootel.find('tr.activity[data-id="'+e+'"]').addClass("deleting"),s.call([{methodname:"local_excursions_formcontrol",args:{action:"delete_activity",data:e},done:function(t){i.rootel.find('tr.activity[data-id="'+e+'"]').remove()},fail:function(t){a.error("local_excursions/index: failed to delete activity."),a.debug(t)}}])}),i.rootel.find("input.show-past-activities").change()},{init:function(){a.debug("local_excursions/index: initializing");var t=o("#page-local-excursions-index");t.length?new e(t).main():a.error("local_excursions/index: #page-local-excursions-index not found!")}}});