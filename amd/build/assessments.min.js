define(["jquery","core/log","core/ajax","core/str"],function(a,o,i,e){"use strict";function t(e){this.rootel=e}return t.prototype.main=function(){var s=this;s.rootel.on("change","select.filter-select",function(e){var t=a(this).find(":selected").val(),n=new URLSearchParams(window.location.search);n.set(a(this).attr("name"),t),s.rootel.find(".excursions-overlay").addClass("active"),window.location.href="//"+location.host+location.pathname+"?"+n.toString()}),s.rootel.on("click",".btn-edit-link",function(e){e.preventDefault();let t=a(this);e=t.data("url");const n=t.data("eventid");let s=prompt("Assessment URL",e);null!==s&&i.call([{methodname:"local_excursions_formcontrol",args:{action:"update_assessmenturl",data:JSON.stringify({eventid:n,url:s})},done:function(){t.data("url",s),a('.assessmentlink[data-eventid="'+n+'"]').attr("href",s)},fail:function(e){alert("Failed to update assessment url."),o.error("local_excursions/assessments: failed to update assessment url."),o.debug(e)}}])})},{init:function(){o.debug("local_excursions/assessments: initializing");var e=a("#page-content");e.length?new t(e).main():o.error("local_excursions/assessments: #page-content not found!")}}});