define(["jquery","core/log","core/ajax","core/str"],function(a,o,i,e){"use strict";function t(e){this.rootel=e}return t.prototype.main=function(){var n=this;n.rootel.on("click",".delete-activity",function(e){e.preventDefault();var t=a(this).closest("tr.activity").data("id");n.rootel.find('tr.activity[data-id="'+t+'"]').addClass("deleting"),i.call([{methodname:"local_excursions_formcontrol",args:{action:"delete_activity",data:t},done:function(e){n.rootel.find('tr.activity[data-id="'+t+'"]').remove()},fail:function(e){o.error("local_excursions/newindex: failed to delete activity."),o.debug(e)}}])}),n.rootel.on("change","select.page-select",function(e){var t=a(this).find(":selected").val(),o=new URLSearchParams(window.location.search);o.set("nav",t),n.rootel.find(".loading-overlay").addClass("active"),window.location.href="//"+location.host+location.pathname+"?"+o.toString()}),n.rootel.on("click","a.page-link",function(e){e.preventDefault();e=new URLSearchParams(window.location.search);e.set("nav",a(this).data("nav")),n.rootel.find(".loading-overlay").addClass("active"),window.location.href="//"+location.host+location.pathname+"?"+e.toString()}),n.rootel.on("change","select.filter-select",function(e){var t=a(this).find(":selected").val(),o=new URLSearchParams(window.location.search);o.set(a(this).attr("name"),t),n.rootel.find(".loading-overlay").addClass("active"),window.location.href="//"+location.host+location.pathname+"?"+o.toString()})},{init:function(){o.debug("local_excursions/newindex: initializing");var e=a("#page-local-excursions-newindex");e.length?new t(e).main():o.error("local_excursions/newindex: #page-local-excursions-newindex not found!")}}});