{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.

    @package   local_excursions
    @copyright 2021 Michael Vangelovski
    @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
}}
{{!
    @template local_excursions/events

    View template.
}}

<div class="local_excursions_events">
  <div class="header">
    {{{nav}}}
    <div class="head-options">
      <a id="btn-createevent" class="btn btn-primary" href="/local/excursions/event.php">Create a new event</a>
    </div>
  </div>
  
  <table class="events">
    <tr>
      <th>Start - end</th>
      <th>title</th>
      <th>Areas</th>
      <th>Details</th>
      <th>Owner</th>
      <th>Actions</th>
    </tr>
  {{#events}}
    <tr class="event" data-eventid={{id}}>
      <td>
        <div class="times">
          <div class="timestart">
            <div class="cal-date">
              <div class="cal-time">{{timestartReadable}}</div>
              <div class="cal-day">{{datestartReadable}}</div>
            </div>
          </div>
          <div>-</div>
          <div class="timeend">
            <div class="cal-date">
              <div class="cal-time">{{timeendReadable}}</div>
              <div class="cal-day">{{dateendReadable}}</div>
            </div>
          </div>
        </div>
        <div>Duration: {{duration}}</div>
        {{#nonnegotiable}}
          <div><span class="badge badge-warning">Non-negotiable</span></div>
          {{reason}}
        {{/nonnegotiable}}
      </td>
      <td>{{eventname}}</td>
      <td>{{#areas}}<span class="badge badge-pill badge-light">{{.}}</span>{{/areas}}</td>
      <td>{{details}}</td>
      <td><div><img class="rounded-circle" height="18" src="{{owner.photourl}}"> <span>{{owner.fullname}}</span></div></td>
      <td>
        <div class="actions">
          
          <div class="conflict-check-results">
            <div class="loading">
              <div class="spinner"><div class="circle spin"></div></div>
              <div>Checking conflicts...</div>
            </div>
            <a class="btn btn-danger btn-showconflicts" href="#" data-eventid="{{id}}">View conflicts</a>
            <div class="text-no-conflicts">No conflicts found</div>
          </div>

          <a class="btn btn-secondary" href="{{editurl}}">Edit</a>

        </div>
      </td>
    </tr>
  {{/events}}
  </table>
  {{{nav}}}
</div>